<!--
 * @Descripttion: 
 * @version: 
 * @Author: WangQing
 * @email: 2749374330@qq.com
 * @Date: 2019-12-03 20:16:09
 * @LastEditors: WangQing
 * @LastEditTime: 2019-12-03 21:09:15
 -->
# TCP拥塞控制

- TCP拥塞控制为**端到端拥塞控制**
- TCP进行拥塞控制的方法
    - 每个发送方自动感知网络拥塞的程度
    - 发送方如何感知拥塞
        - 超时
        - 3个冗余ACK
    - 发送方根据感知的结果限制外发的流量
        - 如果前方路径上出现了拥塞，则降低发送速率
        - 如果前方路径上没有出现拥塞，则增加发送速率
    - 发送方如何限制发送流量速率
        - 引入拥塞窗口

## TCP拥塞控制算法（Remo算法）

- 加性增，乘性减（AIMD）
    - 出现丢包事件后将当前 CongWin 大小减半，可以大大减少注入到网络中的分组数
    - 当没有丢包事件发生了，每个RTT之后将CongWin增大1个MSS，使拥塞窗口缓慢增大，以防止网络过早出现拥塞，线性增长阶段称为拥塞避免（CA，Congestion Avoidance）阶段

### 慢启动

- 建立连接时，CongWin = 1 MSS
- 可用带宽>>MSS/RTT
- 连接初始阶段，以指数的数独增加发送速率，直到发生一个丢包时间为止
    - 每收到一次确认则将CongWin的值增加一个MSS

**初始速率很低但速率的增长速度很快**

### 快速恢复

- 对收到3个重复ACK的反应——快速重传
    - 门限值设为当前CongWin的一半（门限值初始值65kB）
    - 将CongWin减为新的门限值+3MSS
    - 线性增大拥塞窗口
- 对超时事件的反应：设置门限（Threshold）
    - 门限值设为当前CongWin的一半（门限值初始值65kB）
    - 将CongWin设为1个 MSS大小; 
    - 窗口以指数速度增大
    - 窗口增大到门限值之后，再以线性速度增大
- 早期的TCP Tahoe版本对上述两个事件并不区分，统一将CongWin降为1。实际上， 3个重复的ACK相对超时来说是一个预警信号，因此在Reno版中作了区分

## TCP吞吐量

吞吐量 = 窗口大小W/RTT

平均吞吐量 = 1.22*MSS / (RTT * L^0.5)

## 公平性

- 公平性的目标:如果K个TCP连接共享同一个带宽为R的瓶颈链路, 每个连接的平均传输速率为 R/K